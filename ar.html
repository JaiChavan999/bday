<!DOCTYPE html>
<html>
<head>
    <title>Happy Anniversary!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <!-- Link to your wishes data -->
    <script src="wishes.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <!-- Loading Screen -->
    <div id="loading-overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #fff; display: flex; justify-content: center; align-items: center; z-index: 10000;">
        <p style="font-family: sans-serif; font-size: 1.5em;">Please find the marker to see your messages!</p>
    </div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">

        <!-- The Marker -->
        <!-- This uses a preset "HIRO" marker. You must print this marker image. -->
        <a-marker preset="hiro" id="marker">
            <!-- Wishes will be dynamically added here by the script -->
        </a-marker>

        <!-- Static camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        window.onload = () => {
            const marker = document.getElementById('marker');
            const loadingOverlay = document.getElementById('loading-overlay');

            // Hide loading screen when marker is first found
            marker.addEventListener('markerFound', () => {
                if (loadingOverlay) {
                    loadingOverlay.style.display = 'none';
                }
                // Check if wishes have been loaded to prevent re-drawing
                if (marker.children.length === 0) {
                    displayWishes(wishes);
                }
            });
        };

        function displayWishes(wishArray) {
            const marker = document.getElementById('marker');
            const radius = 2.5; // Circle radius
            const angleStep = (2 * Math.PI) / wishArray.length;

            wishArray.forEach((wish, index) => {
                const angle = index * angleStep;
                const x = radius * Math.cos(angle);
                const z = radius * Math.sin(angle);

                // Create a container for the wish
                const wishEntity = document.createElement('a-entity');
                wishEntity.setAttribute('position', `${x} 0.5 ${z}`);
                
                // Make the entity always face the camera
                wishEntity.setAttribute('look-at', '[camera]');

                // Background plane
                const plane = document.createElement('a-plane');
                plane.setAttribute('color', '#007bff');
                plane.setAttribute('width', '2');
                plane.setAttribute('height', '1.2');
                plane.setAttribute('opacity', '0.8');

                // Wish message text
                const msgText = document.createElement('a-text');
                msgText.setAttribute('value', wish.message);
                msgText.setAttribute('color', 'white');
                msgText.setAttribute('align', 'center');
                msgText.setAttribute('width', '1.8');
                msgText.setAttribute('wrap-count', '30'); // Adjust for wrapping
                msgText.setAttribute('position', '0 0.2 0.1');

                // Name text
                const nameText = document.createElement('a-text');
                nameText.setAttribute('value', `- ${wish.name}`);
                nameText.setAttribute('color', '#ffc107');
                nameText.setAttribute('align', 'right');
                nameText.setAttribute('width', '1.8');
                nameText.setAttribute('position', '0 -0.3 0.1');

                wishEntity.appendChild(plane);
                wishEntity.appendChild(msgText);
                wishEntity.appendChild(nameText);
                marker.appendChild(wishEntity);
            });
        }
    </script>
</body>
</html>
 